{"ast":null,"code":"'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\")[\"default\"];\nvar _objectSpread2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectSpread2\"));\nvar stableCopy = require('../util/stableCopy');\nvar invariant = require('invariant');\nvar RelayQueryResponseCache = /*#__PURE__*/function () {\n  function RelayQueryResponseCache(_ref) {\n    var size = _ref.size,\n      ttl = _ref.ttl;\n    !(size > 0) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayQueryResponseCache: Expected the max cache size to be > 0, got ' + '`%s`.', size) : invariant(false) : void 0;\n    !(ttl > 0) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayQueryResponseCache: Expected the max ttl to be > 0, got `%s`.', ttl) : invariant(false) : void 0;\n    this._responses = new Map();\n    this._size = size;\n    this._ttl = ttl;\n  }\n  var _proto = RelayQueryResponseCache.prototype;\n  _proto.clear = function clear() {\n    this._responses.clear();\n  };\n  _proto.get = function get(queryID, variables) {\n    var _this = this;\n    var cacheKey = getCacheKey(queryID, variables);\n    this._responses.forEach(function (response, key) {\n      if (!isCurrent(response.fetchTime, _this._ttl)) {\n        _this._responses[\"delete\"](key);\n      }\n    });\n    var response = this._responses.get(cacheKey);\n    if (response == null) {\n      return null;\n    }\n    if (Array.isArray(response.payload)) {\n      return response.payload.map(function (payload) {\n        return (0, _objectSpread2[\"default\"])((0, _objectSpread2[\"default\"])({}, payload), {}, {\n          extensions: (0, _objectSpread2[\"default\"])((0, _objectSpread2[\"default\"])({}, payload.extensions), {}, {\n            cacheTimestamp: response.fetchTime\n          })\n        });\n      });\n    }\n    return (0, _objectSpread2[\"default\"])((0, _objectSpread2[\"default\"])({}, response.payload), {}, {\n      extensions: (0, _objectSpread2[\"default\"])((0, _objectSpread2[\"default\"])({}, response.payload.extensions), {}, {\n        cacheTimestamp: response.fetchTime\n      })\n    });\n  };\n  _proto.set = function set(queryID, variables, payload) {\n    var fetchTime = Date.now();\n    var cacheKey = getCacheKey(queryID, variables);\n    this._responses[\"delete\"](cacheKey);\n    this._responses.set(cacheKey, {\n      fetchTime: fetchTime,\n      payload: payload\n    });\n    if (this._responses.size > this._size) {\n      var firstKey = this._responses.keys().next();\n      if (!firstKey.done) {\n        this._responses[\"delete\"](firstKey.value);\n      }\n    }\n  };\n  return RelayQueryResponseCache;\n}();\nfunction getCacheKey(queryID, variables) {\n  return JSON.stringify(stableCopy({\n    queryID: queryID,\n    variables: variables\n  }));\n}\nfunction isCurrent(fetchTime, ttl) {\n  return fetchTime + ttl >= Date.now();\n}\nmodule.exports = RelayQueryResponseCache;","map":{"version":3,"names":["_interopRequireDefault","require","_objectSpread2","stableCopy","invariant","RelayQueryResponseCache","_ref","size","ttl","process","env","NODE_ENV","_responses","Map","_size","_ttl","_proto","prototype","clear","get","queryID","variables","_this","cacheKey","getCacheKey","forEach","response","key","isCurrent","fetchTime","Array","isArray","payload","map","extensions","cacheTimestamp","set","Date","now","firstKey","keys","next","done","value","JSON","stringify","module","exports"],"sources":["/Users/joaoluismoraes/Desktop/woovi-challenge/web/node_modules/relay-runtime/lib/network/RelayQueryResponseCache.js"],"sourcesContent":["'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\")[\"default\"];\nvar _objectSpread2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectSpread2\"));\nvar stableCopy = require('../util/stableCopy');\nvar invariant = require('invariant');\nvar RelayQueryResponseCache = /*#__PURE__*/function () {\n  function RelayQueryResponseCache(_ref) {\n    var size = _ref.size,\n      ttl = _ref.ttl;\n    !(size > 0) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayQueryResponseCache: Expected the max cache size to be > 0, got ' + '`%s`.', size) : invariant(false) : void 0;\n    !(ttl > 0) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayQueryResponseCache: Expected the max ttl to be > 0, got `%s`.', ttl) : invariant(false) : void 0;\n    this._responses = new Map();\n    this._size = size;\n    this._ttl = ttl;\n  }\n  var _proto = RelayQueryResponseCache.prototype;\n  _proto.clear = function clear() {\n    this._responses.clear();\n  };\n  _proto.get = function get(queryID, variables) {\n    var _this = this;\n    var cacheKey = getCacheKey(queryID, variables);\n    this._responses.forEach(function (response, key) {\n      if (!isCurrent(response.fetchTime, _this._ttl)) {\n        _this._responses[\"delete\"](key);\n      }\n    });\n    var response = this._responses.get(cacheKey);\n    if (response == null) {\n      return null;\n    }\n    if (Array.isArray(response.payload)) {\n      return response.payload.map(function (payload) {\n        return (0, _objectSpread2[\"default\"])((0, _objectSpread2[\"default\"])({}, payload), {}, {\n          extensions: (0, _objectSpread2[\"default\"])((0, _objectSpread2[\"default\"])({}, payload.extensions), {}, {\n            cacheTimestamp: response.fetchTime\n          })\n        });\n      });\n    }\n    return (0, _objectSpread2[\"default\"])((0, _objectSpread2[\"default\"])({}, response.payload), {}, {\n      extensions: (0, _objectSpread2[\"default\"])((0, _objectSpread2[\"default\"])({}, response.payload.extensions), {}, {\n        cacheTimestamp: response.fetchTime\n      })\n    });\n  };\n  _proto.set = function set(queryID, variables, payload) {\n    var fetchTime = Date.now();\n    var cacheKey = getCacheKey(queryID, variables);\n    this._responses[\"delete\"](cacheKey);\n    this._responses.set(cacheKey, {\n      fetchTime: fetchTime,\n      payload: payload\n    });\n    if (this._responses.size > this._size) {\n      var firstKey = this._responses.keys().next();\n      if (!firstKey.done) {\n        this._responses[\"delete\"](firstKey.value);\n      }\n    }\n  };\n  return RelayQueryResponseCache;\n}();\nfunction getCacheKey(queryID, variables) {\n  return JSON.stringify(stableCopy({\n    queryID: queryID,\n    variables: variables\n  }));\n}\nfunction isCurrent(fetchTime, ttl) {\n  return fetchTime + ttl >= Date.now();\n}\nmodule.exports = RelayQueryResponseCache;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}